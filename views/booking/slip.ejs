<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Slip - <%= booking.bookingNo %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .print-container {
                box-shadow: none !important;
                margin: 0;
                padding: 2mm;
                width: 100%;
            }
            .title {
                font-size: 17px !important;
                margin-bottom: 4px !important;
            }
            .header-table {
                font-size: 10.5px !important;
                margin-bottom: 3px !important;
            }
            .header-table td {
                padding: 2px 3px !important;
            }
            .section-header {
                font-size: 11.5px !important;
                margin-top: 4px !important;
                margin-bottom: 2px !important;
                padding: 2px 5px !important;
            }
            .detail-table {
                font-size: 10.5px !important;
                margin-bottom: 2px !important;
            }
            .detail-table td {
                padding: 1.5px 3px !important;
            }
            .banking-section {
                margin-top: 4px !important;
            }
            .banking-section td {
                font-size: 10.5px !important;
                padding: 4px !important;
            }
            .banking-section .left-col table tr td {
                padding: 1.5px 0 !important;
            }
            .banking-section .right-col > div:first-child {
                margin-bottom: 27px !important;
            }
            .banking-section .right-col > div:last-child {
                margin-top: 7px !important;
            }
            .terms {
                font-size: 8.5px !important;
                margin-top: 4px !important;
                line-height: 1.25 !important;
            }
            .terms ol {
                margin: 2px 0 !important;
                padding-left: 12px !important;
            }
            .terms li {
                margin-bottom: 1.5px !important;
            }
            .terms ul {
                margin: 1.5px 0 !important;
                padding-left: 12px !important;
            }
            .terms ul li {
                margin-bottom: 1px !important;
            }
        }
        body {
            background-color: #f5f5f5;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
        }
        .print-container {
            max-width: 210mm;
            width: 100%;
            margin: 0 auto;
            background: white;
            padding: 15mm;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .header-table {
            width: 100%;
            margin-bottom: 10px;
            font-size: 9px;
            border-collapse: collapse;
        }
        .header-table td {
            border: 1px solid #000;
            padding: 5px;
        }
        .header-table .label {
            font-weight: bold;
        }
        .section-header {
            background-color: #d3d3d3;
            padding: 4px 8px;
            font-weight: bold;
            font-size: 10px;
            margin-top: 10px;
            margin-bottom: 5px;
            border: 1px solid #000;
        }
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 9px;
            margin-bottom: 5px;
        }
        .detail-table td {
            padding: 3px 5px;
            vertical-align: top;
        }
        .detail-table .label {
            font-weight: bold;
            width: 150px;
            white-space: nowrap;
        }
        .detail-table .value {
            width: auto;
        }
        .banking-section {
            width: 100%;
            margin-top: 10px;
            border-collapse: collapse;
        }
        .banking-section td {
            vertical-align: top;
            font-size: 9px;
            padding: 5px;
        }
        .banking-section .left-col {
            width: 35%;
            border: 1px solid #000;
            padding: 10px;
        }
        .banking-section .right-col {
            width: 65%;
            border: 1px solid #000;
            border-left: none;
            padding: 10px;
            position: relative;
        }
        .banking-section .right-col > div:first-child {
            margin-bottom: 40px;
        }
        .banking-section .right-col > div:last-child {
            margin-top: 20px;
        }
        .signature-area {
            margin-top: 40px;
            text-align: center;
        }
        .terms {
            margin-top: 15px;
            font-size: 8px;
            line-height: 1.5;
        }
        .terms ol {
            margin: 5px 0;
            padding-left: 15px;
        }
        .terms li {
            margin-bottom: 5px;
        }
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        @page {
            size: A4 portrait;
            margin: 20mm -5mm 0mm -5mm;
        }
    </style>
</head>
<body>
    <!-- Print Button -->
    <button onclick="window.print()" class="btn btn-primary no-print print-button">
        <i class="bi bi-printer"></i> Print
    </button>

    <div class="print-container">
        <%
        // Calculate payment details
        const baseAmount = parseFloat(booking.area) * parseFloat(booking.rate);
        const plcPercent = parseFloat(booking.plc) || 0;
        const plcAmount = baseAmount * (plcPercent / 100);
        const totalAmount = parseFloat(booking.totalAmount);
        const discount = parseFloat(booking.discount) || 0;
        const effectiveRate = parseFloat(booking.effectiveRate);
        
        // Get first payment if exists
        const firstPayment = payments && payments.length > 0 ? payments[0] : null;
        %>
        
        <!-- Title -->
        <div class="title">BOOKING APPLICATION FORM</div>

        <!-- Header Information -->
        <table class="header-table">
            <tr>
                <td style="width: 50%;"><span class="label">Booking Appl. No.</span> : <b><%= booking.bookingNo %></b></td>
                <td style="width: 50%;"><span class="label">Booking Date :</span> <%= new Date(booking.bookingDate).toLocaleDateString('en-IN') %></td>
            </tr>
        </table>

        <!-- APPLICANTS DETAILS Section -->
        <div class="section-header">APPLICANTS DETAILS</div>
        <table class="detail-table">
            <tr>
                <td class="label">Mr./Ms./Mrs/M+Dr</td>
                <td class="value" colspan="3">: <%= booking.customer.applicantName %></td>
            </tr>
            <tr>
                <td class="label">Son/Wife/Daughter of</td>
                <td class="value" style="width: 40%;">: <%= booking.customer.fatherOrHusbandName || 'NA' %></td>
                <td class="label" style="width: 100px;"></td>
                <td class="value"></td>
            </tr>
            <tr>
                <td class="label">Aadhar No.</td>
                <td class="value" style="width: 40%;">: <%= booking.customer.aadhaarNo || 'NA' %></td>
                <td class="label" style="width: 100px;">Mobile No.:</td>
                <td class="value"><%= booking.customer.mobileNo || 'NA' %></td>
            </tr>
            <tr>
                <td class="label">Address</td>
                <td class="value" colspan="3">: <%= booking.customer.address %></td>
            </tr>
        </table>

        <!-- PROPERTY DETAILS Section -->
        <div class="section-header">PROPERTY DETAILS</div>
        <table class="detail-table">
            <tr>
                <td class="label">Project Name</td>
                <td class="value" colspan="3">: <%= booking.project.projectName %></td>
            </tr>
            <tr>
                <td class="label">Plot No.</td>
                <td class="value" style="width: 25%;">: <%= booking.plotNo %></td>
                <td class="label" style="width: 140px;">Area (In Sqft):</td>
                <td class="value" style="width: 25%;"><%= booking.area %></td>
                <td class="label" style="width: 120px;">PLC (in %):</td>
                <td class="value"><%= plcPercent %></td>
            </tr>
            <% if (booking.legalDetails) { %>
            <tr>
                <td class="label">Legal Details</td>
                <td class="value" colspan="5">: <%= booking.legalDetails %></td>
            </tr>
            <% } %>
        </table>

        <!-- PAYMENT DETAILS Section -->
        <div class="section-header">PAYMENT DETAILS</div>
        <table class="detail-table">
            <tr>
                <td class="label">Rate ( Per Sqft in Rs.)</td>
                <td class="value" style="width: 25%;">: <%= parseFloat(booking.rate).toLocaleString('en-IN') %></td>
                <td class="label" style="width: 140px;">Discount (Rs):</td>
                <td class="value" style="width: 25%;"><%= discount %></td>
                <td class="label" style="width: 140px;">Effective Rate :</td>
                <td class="value"><%= effectiveRate %></td>
            </tr>
            <tr>
                <td class="label">Total Amount (Rs.)</td>
                <td class="value" colspan="5">: <strong>₹ <%= totalAmount.toLocaleString('en-IN') %></strong> &nbsp;&nbsp;&nbsp; ( Rupees <%= numberToWords(totalAmount) %> Only )</td>
            </tr>
        </table>

        <!-- BOOKING DETAILS Section -->
        <div class="section-header">BOOKING DETAILS</div>
        <table class="detail-table">
            <% if (firstPayment) { %>
            <tr>
                <td class="label">Booking Amount (Rs.)</td>
                <td class="value" colspan="5">: <strong>₹ <%= parseFloat(firstPayment.paymentAmount).toLocaleString('en-IN') %></strong> &nbsp;&nbsp;&nbsp; ( Rupees <%= numberToWords(parseFloat(firstPayment.paymentAmount)) %> Only )</td>
            </tr>
            <tr>
                <td class="label">Payment Mode</td>
                <td class="value" colspan="2">: <%= firstPayment.paymentMode %></td>
                <td class="label" style="width: 100px;">Date :</td>
                <td class="value" colspan="2"><%= new Date(firstPayment.receiptDate).toLocaleDateString('en-IN') %></td>
            </tr>
            <tr>
                <td class="label">Transaction No.</td>
                <td class="value" colspan="5">: <%= firstPayment.transactionNo || 'NA' %></td>
            </tr>
            <tr>
                <td class="label">Remarks (If Any)</td>
                <td class="value" colspan="5">: <%= firstPayment.remarks || 'NA' %></td>
            </tr>
            <% } else { %>
            <tr>
                <td class="label">Booking Amount (Rs.)</td>
                <td class="value" colspan="5">: <strong>₹ 0</strong> &nbsp;&nbsp;&nbsp; ( No Payment Received Yet )</td>
            </tr>
            <% } %>
        </table>

        <!-- BANKING DETAILS Section -->
        <div class="section-header">BANKING DETAILS</div>
        <table class="banking-section">
            <tr>
                <td class="left-col">
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="font-weight: bold; width: 80px; padding: 2px 0;">Name</td>
                            <td style="padding: 2px 0;">: DS Infra Developers</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; padding: 2px 0;">Acc. No.</td>
                            <td style="padding: 2px 0;">: 7199926523</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; padding: 2px 0;">IFSC</td>
                            <td style="padding: 2px 0;">: IDIB000A532</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; padding: 2px 0;">Acc. Type</td>
                            <td style="padding: 2px 0;">: Current</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; padding: 2px 0;">Bank</td>
                            <td style="padding: 2px 0;">: Indian Bank</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; padding: 2px 0;">Branch</td>
                            <td style="padding: 2px 0;">: Ahimamau, Lucknow</td>
                        </tr>
                    </table>
                </td>
                <td class="right-col">
                    <div style="position: absolute; top: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; width: calc(100% - 20px);">
                        <div style="width: 150px;"></div>
                        <div style="text-align: center; width: 150px;">
                            <div style="font-weight: bold; font-size: 10px;">FOR DS INFRA DEVELOPERS & BUILDERS PVT LTD</div>
                        </div>
                    </div>
                    <div style="position: absolute; bottom: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; width: calc(100% - 20px);">
                        <div style="text-align: center;">
                            <div style="width: 150px; margin-bottom: 5px;"></div>
                            <div>(Customer Signature)</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 150px; margin-bottom: 5px;"></div>
                            <div>(Authorised Signatory)</div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Terms and Conditions Section -->
        <div class="section-header">[TERMS & CONDITION]</div>
        <div class="terms">
            <ol>
                <li>The Applicant has/have submitted this application requesting allotment of a Unit in the Project as mentioned above.</li>
                <li>DS Infra Developers & Builders Pvt Ltd reserves the absolute right to either allot or reject the allotment of the unit(s) requested by the applicant(s), which shall be subject to the availability of such units.</li>
                <li>This application will be processed only after the realization of the booking amount mentioned in the payment details. The stamp duty and registration charges applicable shall be borne by the applicant, as per prevailing laws, shall not be borne entirely by the applicant(s).</li>
                <li>Applicable bank charges shall be levied on outstation cheques. In case the cheque or payment instrument is returned unpaid for any reason, the booking will automatically stand cancelled without any further notice.</li>
                <li>By signing this application form, the applicant(s) affirm that they have personally visited and inspected the project location, verified all details, and are fully satisfied with the site, its surroundings, and neighbourhood. The applicant(s) also confirm that they have understood the scheme of development and other project details.</li>
                <li>The Applicant confirms that he/she has read all the terms and conditions of allotment and found them to be fair and binding. After the waiting period, the company reserves the right to cancel or re-allot the booking at its sole discretion.</li>
                <li>Cancellation and Refund Policy:
                    <ul style="list-style-type: disc; margin-top: 3px;">
                        <li>No refund shall be made to the unit allottee if the booking is cancelled within 30 (thirty) days from the date of cancellation.</li>
                        <li>No decision regarding refund of the full (or partial) booking amount shall rest solely with the company officials, and the applicant(s) shall not raise any objection to the same.</li>
                        <li>Any deduction or forfeiture of any amount shall be as per prevailing laws and as decided by the company.</li>
                    </ul>
                </li>
                <li>DS Infra Developers & Builders Pvt Ltd  shall not be held liable for any delay or failure in performance of obligations due to causes beyond its reasonable control, including but not limited to natural calamities, government orders, legal disputes, or other unforeseen events.</li>
                <li>All communication with the applicant(s) shall be sent to the address/contact details provided by the applicant(s) in this form. The company shall not be responsible for any non-receipt of communication due to incorrect or outdated contact details.</li>
                <li>All disputes or legal proceedings arising out of this application shall be subject to the exclusive jurisdiction of the courts at Lucknow (U.P.) only.</li>
            </ol>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
